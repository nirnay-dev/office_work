<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Video Player</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background-color: #f0f0f0; /* Light mode background */
            color: #333; /* Light mode text color */
            transition: background-color 0.3s, color 0.3s;
            position: relative; /* Needed for fixed dark mode toggle */
            min-height: 100vh; /* Ensure body takes full viewport height */
            box-sizing: border-box; /* Include padding in element's total width and height */
        }
        /* Dark mode styles */
        body.dark-mode {
            background-color: #222; /* Dark mode background */
            color: #eee; /* Dark mode text color */
        }

        .container {
            background-color: white; /* Light mode container background */
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            width: 100%; /* Make container responsive to screen width */
            /* max-width will be controlled by JavaScript based on slider */
            text-align: center;
            transition: background-color 0.3s, box-shadow 0.3s, max-width 0.3s ease-out; /* Add max-width transition */
            margin-top: 20px; /* Space from slider */
        }
        /* Dark mode container */
        body.dark-mode .container {
            background-color: #333;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
        }

        h1 {
            color: #333; /* Light mode heading color */
            margin-bottom: 25px;
        }
        /* Dark mode heading */
        body.dark-mode h1 {
            color: #eee;
        }

        .input-group {
            margin-bottom: 25px;
            display: flex;
            flex-wrap: wrap; /* Allow input and button to wrap on smaller screens */
            justify-content: center;
            gap: 10px;
        }
        input[type="text"] {
            flex-grow: 1;
            padding: 12px;
            border: 1px solid #ddd; /* Light mode input border */
            border-radius: 5px;
            font-size: 16px;
            max-width: 400px; /* Limit input width */
            background-color: white; /* Light mode input background */
            color: #333; /* Light mode input text */
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }
        /* Dark mode input */
        body.dark-mode input[type="text"] {
            background-color: #444;
            color: #eee;
            border-color: #555;
        }

        button {
            padding: 12px 25px;
            background-color: #ff0000;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease, opacity 0.3s ease;
            display: flex; /* Allow content inside button to be flexed */
            align-items: center; /* Vertically align content */
            justify-content: center; /* Horizontally align content */
        }
        button:hover:not(:disabled) { /* Hover effect only if not disabled */
            background-color: #cc0000;
        }
        button:disabled {
            background-color: #999;
            cursor: not-allowed;
            opacity: 0.7;
        }

        /* Dark mode toggle button specific styles */
        #darkModeToggle {
            background-color: #666;
            color: white; /* This will be the fill color for the SVG if current color is used */
            width: 50px; /* Fixed width for a square button */
            height: 50px; /* Fixed height for a square button */
            padding: 0; /* Remove padding to make icon fill the button */
            border-radius: 50%; /* Make it round */
            position: fixed; /* Position relative to the viewport */
            top: 20px; /* 20px from the top */
            right: 20px; /* 20px from the right */
            z-index: 1000; /* Ensure it's above other content */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Subtle shadow */
        }

        #darkModeToggle:hover {
            background-color: #555;
        }

        #darkModeToggle svg {
            width: 28px; /* Slightly larger for better visibility */
            height: 28px;
            /* Default fill for icons, can be overridden per icon */
        }

        /* Specific styles for moon icon (visible in light mode, suggests dark mode) */
        #moonIcon {
            fill: #FFD700; /* Yellow fill as in your image for the moon */
            stroke: #333; /* Dark outline for visibility on light button/background */
            stroke-width: 1.5px;
        }

        /* Specific styles for sun icon (visible in dark mode, suggests light mode) */
        #sunIcon {
            fill: #FFD700; /* Yellow fill for the sun */
            stroke: #333; /* Dark outline for visibility on dark button/background */
            stroke-width: 1.5px;
        }


        /*
           *** IMPORTANT FOR RESPONSIVE IFRAME SIZE ***
           This block makes the iframe flexible and maintains its 16:9 aspect ratio.
           The 'padding-bottom: 56.25%;' is 9/16 * 100%.
        */
        .video-container {
            margin-top: 30px;
            position: relative;
            width: 100%; /* Take full width of its parent */
            padding-bottom: 56.25%; /* This creates the 16:9 aspect ratio (height is 56.25% of width) */
            height: 0; /* Ensures the padding-bottom defines the height */
            overflow: hidden;
            background-color: #000;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Improved Error Message Styling */
        #error-message {
            color: #cc0000; /* Darker red for text */
            background-color: #ffe6e6; /* Light red background */
            border: 1px solid #ffb3b3; /* Red border */
            padding: 10px 15px;
            margin-top: 15px;
            border-radius: 5px;
            display: none; /* Hidden by default */
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        /* Dark mode error message */
        body.dark-mode #error-message {
            background-color: #4a0000;
            color: #ffcccc;
            border-color: #ff6666;
        }

        /* Loading Indicator Styling */
        .video-container.loading::before { /* Use ::before for the loading text */
            content: "Loading video...";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 1.2em;
            z-index: 1; /* Ensure text is above potential spinner */
        }
        .video-container.loading::after { /* Use ::after for the spinner */
            content: '';
            position: absolute;
            top: calc(50% + 20px); /* Position below text */
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 30px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top: 4px solid #ff0000; /* YouTube red */
            border-radius: 50%;
            animation: spin 1s linear infinite;
            z-index: 1;
        }
        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }
        .video-container.loading iframe {
            visibility: hidden; /* Hide iframe while loading */
        }


        /* Slider specific styles */
        .slider-group {
            margin-bottom: 10px; /* Reduced margin */
            text-align: center;
            width: 100%;
            max-width: 600px; /* Adjusted max-width for slider group */
            padding: 10px;
            box-sizing: border-box;
        }
        .slider-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        /* Style for displaying current slider value */
        #currentSliderValue {
            margin-left: 5px;
            font-weight: normal;
        }

        #iframeSizeSlider {
            width: 80%;
            max-width: 500px;
            margin-top: 10px;
            -webkit-appearance: none; /* Remove default styling */
            appearance: none;
            height: 8px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
            border-radius: 5px;
        }

        #iframeSizeSlider:hover {
            opacity: 1;
        }

        #iframeSizeSlider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ff0000;
            cursor: pointer;
        }

        #iframeSizeSlider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #ff0000;
            cursor: pointer;
        }
        
        /* Dark mode slider styles */
        body.dark-mode #iframeSizeSlider {
            background: #555;
        }
        body.dark-mode #iframeSizeSlider::-webkit-slider-thumb {
            background: #ff4d4d;
        }
        body.dark-mode #iframeSizeSlider::-moz-range-thumb {
            background: #ff4d4d;
        }

        /* Responsiveness Breakpoints */
        @media (max-width: 600px) {
            body {
                padding: 10px;
            }
            .container {
                padding: 15px;
            }
            h1 {
                font-size: 1.5em;
                margin-bottom: 15px;
            }
            .input-group {
                flex-direction: column; /* Stack input and button */
                gap: 5px;
            }
            input[type="text"] {
                max-width: 100%; /* Allow input to take full width */
            }
            button {
                width: 100%; /* Make button full width */
            }
            #darkModeToggle {
                width: 40px;
                height: 40px;
                top: 10px;
                right: 10px;
            }
            #darkModeToggle svg {
                width: 20px;
                height: 20px;
            }
            .slider-group {
                padding: 5px;
            }
        }
    </style>
</head>
<body>
    <button id="darkModeToggle">
        <svg id="moonIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
        </svg>

        <svg id="sunIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="display: none;">
            <circle cx="12" cy="12" r="5"/>
            <line x1="12" y1="1" x2="12" y2="3"/>
            <line x1="12" y1="21" x2="12" y2="23"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
            <line x1="1" y1="12" x2="3" y2="12"/>
            <line x1="21" y1="12" x2="23" y2="12"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
    </button>

    <div class="slider-group">
        <label for="iframeSizeSlider">Adjust Video Player Size: <span id="currentSliderValue">700px</span></label>
        <input type="range" id="iframeSizeSlider" min="300" max="1000" value="700">
    </div>

    <div class="container" id="videoPlayerContainer">
        <h1>Simple YouTube Video Player</h1>
        <div class="input-group">
            <input type="text" id="youtubeLink" placeholder="Paste YouTube link here (e.g., https://www.youtube.com/watch?v=dQw4w9WgXcQ)">
            <button id="playButton" disabled>Play Video</button>
        </div>
        <p id="error-message">Please enter a valid YouTube video URL.</p>
        <div class="video-container">
            <iframe id="videoFrame"
                    src=""
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen>
            </iframe>
        </div>
    </div>

    <script>
        // DOM element references (cached for efficiency)
        const body = document.body;
        const darkModeToggle = document.getElementById('darkModeToggle');
        const sunIcon = document.getElementById('sunIcon');
        const moonIcon = document.getElementById('moonIcon');
        const youtubeLinkInput = document.getElementById('youtubeLink');
        const playButton = document.getElementById('playButton');
        const videoFrame = document.getElementById('videoFrame');
        const errorMessage = document.getElementById('error-message');
        const videoContainer = document.querySelector('.video-container');
        const iframeSizeSlider = document.getElementById('iframeSizeSlider');
        const currentSliderValueSpan = document.getElementById('currentSliderValue');
        const videoPlayerContainer = document.getElementById('videoPlayerContainer'); // The .container div

        /**
         * Extracts the YouTube video ID from a given YouTube URL.
         * Supports various YouTube URL formats.
         * @param {string} url - The YouTube video URL.
         * @returns {string|null} The video ID if found, otherwise null.
         */
        function getYouTubeVideoId(url) {
            // Updated regex to more robustly capture video IDs from various YouTube URL formats
            const regex = /(?:https?:\/\/(?:www\.)?youtube\.com\/(?:watch\?v=|embed\/|v\/|)([a-zA-Z0-9_-]{11})(?:\S+)?|https?:\/\/youtu\.be\/([a-zA-Z0-9_-]{11}))/;
            const match = url.match(regex);
            return (match && (match[1] || match[2])) ? (match[1] || match[2]) : null;
        }

        /**
         * Loads a YouTube video into the iframe based on the provided URL.
         */
        function loadVideo() {
            const link = youtubeLinkInput.value.trim();

            errorMessage.style.display = 'none';
            errorMessage.textContent = '';
            videoContainer.classList.remove('loading'); // Ensure loading state is reset

            if (link === '') {
                errorMessage.textContent = 'Please paste a YouTube link.';
                errorMessage.style.display = 'block';
                videoFrame.src = '';
                videoFrame.style.visibility = 'hidden'; // Ensure iframe is hidden when empty
                return;
            }

            const videoId = getYouTubeVideoId(link);

            if (videoId) {
                videoContainer.classList.add('loading'); // Show loading indicator
                videoFrame.style.visibility = 'hidden'; // Hide iframe until loaded
                // Using www.youtube.com/embed/ for standard embeds.
                // For privacy-enhanced mode, you would use 'https://www.youtube-nocookie.com/embed/'
                // Note: Always use HTTPS for embeds where possible.
                videoFrame.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&controls=1&rel=0&modestbranding=1`;

                // Set a timeout to clear loading if it takes too long or fails
                const loadingTimeout = setTimeout(() => {
                    videoContainer.classList.remove('loading');
                    errorMessage.textContent = 'Video took too long to load or failed. Please check the URL or your internet connection.';
                    errorMessage.style.display = 'block';
                    videoFrame.src = ''; // Clear src to stop further attempts
                    videoFrame.style.visibility = 'hidden';
                }, 10000); // 10 seconds timeout

                videoFrame.onload = () => {
                    clearTimeout(loadingTimeout); // Clear timeout on successful load
                    videoContainer.classList.remove('loading');
                    videoFrame.style.visibility = 'visible'; // Make iframe visible after loading
                };
                 videoFrame.onerror = () => { // Catch errors if iframe fails to load
                    clearTimeout(loadingTimeout);
                    videoContainer.classList.remove('loading');
                    errorMessage.textContent = 'Failed to load video. Ensure the URL is correct and the video is embeddable.';
                    errorMessage.style.display = 'block';
                    videoFrame.src = ''; // Clear src
                    videoFrame.style.visibility = 'hidden';
                };


            } else {
                errorMessage.textContent = 'Invalid YouTube URL. Please make sure it\'s a direct video link (e.g., https://www.youtube.com/watch?v=...).';
                errorMessage.style.display = 'block';
                videoFrame.src = ''; // Clear existing video
                videoFrame.style.visibility = 'hidden'; // Ensure iframe is hidden
            }
        }

        /**
         * Toggles dark mode on and off.
         * Stores the preference in localStorage and switches the displayed icon (standard logic).
         */
        function toggleDarkMode() {
            body.classList.toggle('dark-mode');

            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
                moonIcon.style.display = 'none'; // Hide moon (current is dark, so button changes to sun)
                sunIcon.style.display = 'inline-block'; // Show sun
            } else {
                localStorage.setItem('darkMode', 'disabled');
                moonIcon.style.display = 'inline-block'; // Show moon (current is light, so button changes to moon)
                sunIcon.style.display = 'none'; // Hide sun
            }
        }

        /**
         * Updates the max-width of the video player container based on the slider value.
         * Also updates the displayed value next to the slider.
         * @param {string} sliderValue - The current value of the slider.
         */
        function updateIframeSize(sliderValue) {
            videoPlayerContainer.style.maxWidth = `${sliderValue}px`;
            currentSliderValueSpan.textContent = `${sliderValue}px`;
        }

        /**
         * Enables/disables the Play Video button based on input field content.
         */
        function togglePlayButtonState() {
            playButton.disabled = youtubeLinkInput.value.trim() === '';
        }

        // --- Event Listeners and Initial Setup ---

        // Dark mode toggle button click
        darkModeToggle.addEventListener('click', toggleDarkMode);

        // Play button click
        playButton.addEventListener('click', loadVideo);

        // Input field change/input for button state
        youtubeLinkInput.addEventListener('input', togglePlayButtonState);

        // Slider input event to update iframe size and display value
        iframeSizeSlider.addEventListener('input', (event) => {
            updateIframeSize(event.target.value);
        });


        // On page load
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize dark mode
            if (localStorage.getItem('darkMode') === 'enabled') {
                body.classList.add('dark-mode');
                moonIcon.style.display = 'none';
                sunIcon.style.display = 'inline-block';
            } else {
                moonIcon.style.display = 'inline-block';
                sunIcon.style.display = 'none';
            }

            // Initialize iframe size based on the slider's default value
            updateIframeSize(iframeSizeSlider.value);

            // Initialize play button state
            togglePlayButtonState();

            // Ensure iframe is hidden on initial load until a video is played
            videoFrame.style.visibility = 'hidden';
        });
    </script>
</body>
</html>
